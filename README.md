# Introduction and Motivation
Custom keyboard layouts are an option to those who want to expand the functionality of their keyboards, whether to type uncommon symbols or to define custom macros.  
Many applications for creating custom layouts exist, such as [AutoHotKey][AutoHotKey] and [Microsoft's Keyboard Layout Creator][MSKLC], with varying capabilities and learning curves. However, they are not capable of remapping more than one keyboard simultaneously.  
On the other hand, the software [LuaMacros][LuaMacros], by Petr Medek, allows for using multiple keyboards in Windows, but does not offer custom layout functionality. It is instead focused on executing macros written in the Lua language.

The obstable in implementing such functionality is that the Windows operating system does not allow for multiple keyboard layouts to be used at once. If more than one keyboard is connected to the computer, they all share certain states (such as CapsLock), and their layout. Additionally, a Windows program (normally) has no way of identifying which keyboard device a keystroke message came from.

Typically, keystrokes are intercepted using either a Keyboard Hook or the RawInput API, both from the Windows API. Through a Keyboard Hook, it is possible to modify or even block a message generated by a keystroke, but the program cannot extract information about which device originated that message.

The RawInput API, on the other hand, does provide low-level information that includes the device's name. However, it is not possible to manipulate the messages received this way.

[This article][Blecha on Remapping] by VÃ­t Blecha describes how to selectively block keyboard keystrokes based on which device the signal came from, showing that it should be possible for an application to treat keystrokes differently for different keyboards. That, combined with an internal model of a keyboard layout, should enable a user to effectively remap multiple keyboards using different layouts.

This application aims at providing such a solution: to allow the user to create and use multiple keyboard layouts at once in the Windows Operating System.


The user interface for this program is a Layout Editor, written in C# (with WPF), targeting the .NET framework version 4.5. Its goal is to make it easy to create and use any number of custom layouts for any purpose.

# Getting Started
This app is developed in Visual Studio 2017 targeting Windows 7 or higher. The core project in Visual C++ interacts with the Windows API to intercept and substitute keystrokes according to a configuration file in XML. The Layout Editor is written in C# WPF, and is used to edit configuration files that contain the layouts for the different registered keyboards; it also writes the XML configuration files and controls the lifetime of the core application.  

# Build and Run
Buiding the solution should be simple. One important detail, however, is that the Layout Editor points to the Release folders of the C++ projects; as such, it's necessary to build at least the C++ projects in Release mode before building and running the Layout Editor.  


[AutoHotKey]: https://autohotkey.com/
[MSKLC]: https://msdn.microsoft.com/en-us/globalization/keyboardlayouts.aspx
[Blecha on Remapping]: https://www.codeproject.com/Articles/716591/Combining-Raw-Input-and-keyboard-Hook-to-selective
[LuaMacros]: https://github.com/me2d13/luamacros